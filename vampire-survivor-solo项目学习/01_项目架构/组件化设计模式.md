# 组件化设计模式（Composition over Inheritance）

## 核心思想

> "组合优于继承" - 通过组合通用组件来赋予游戏实体各种能力，而不是通过多层继承。

## 对比示例

### ❌ 传统继承方式（不推荐）

```
Node2D
└── CharacterBody2D
    └── Enemy
        └── FastEnemy（重写移动逻辑）
        └── TankEnemy（重写生命值逻辑）
```

问题：每种新类型都需要新建类，代码重复。

### ✅ 组件化方式（推荐）

```
CharacterBody2D
├── HealthComponent（生命值）
├── VelocityComponent（移动）
├── HitBoxComponent（攻击判定）
├── HurtBoxComponent（受击判定）
└── DeathComponent（死亡处理）
```

## 组件化优势

1. **按需组合** - 想要什么功能就挂载什么组件
2. **易于维护** - 修改一个组件影响所有使用它的实体
3. **便于测试** - 组件可以独立测试
4. **灵活扩展** - 新增组件不影响现有代码

## 组件定义规范

```gdscript
# 组件基类示例
extends Node
class_name HealthComponent

@export var max_health: float = 10.0
var current_health: float

signal died
signal health_changed

func damage(amount: float) -> void:
    current_health = clamp(current_health - amount, 0, max_health)
    health_changed.emit()
    if amount > 0:
        Callable(check_death).call_deferred()
```

## 使用场景

| 需求 | 组件 | 使用位置 |
|------|------|----------|
| 生命值管理 | HealthComponent | 玩家、敌人、Boss |
| 移动控制 | VelocityComponent | 玩家、敌人 |
| 攻击判定 | HitBoxComponent | 子弹、技能、敌人本体 |
| 受击判定 | HurtBoxComponent | 玩家、敌人 |
| 死亡处理 | DeathComponent | 敌人、玩家 |
